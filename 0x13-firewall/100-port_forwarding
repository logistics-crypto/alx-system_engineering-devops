# /etc/ufw/before.rules

*nat
:PREROUTING ACCEPT [0:0]
-A PREROUTING -p tcp --dport 8080 -j REDIRECT --to-port 80
-A OUTPUT -p tcp --dport 8080 -j REDIRECT --to-port 80
COMMIT

# Don't delete these required lines, otherwise, ufw will not work
*filter
:ufw-before-input - [0:0]
:ufw-before-output - [0:0]
:ufw-before-forward - [0:0]
:ufw-not-local - [0:0]
# End required lines

# ... (existing rules)

# Allow SSH connections
-A ufw-before-input -p tcp --dport 22 -j ACCEPT

# Allow HTTP and HTTPS connections
-A ufw-before-input -p tcp --dport 80 -j ACCEPT
-A ufw-before-input -p tcp --dport 443 -j ACCEPT

# ... (other rules)

# End existing rules

# Allow traffic from 8080 to 80 (forwards)
-A ufw-before-forward -p tcp --dport 80 -j ACCEPT
-A ufw-before-forward -p tcp --dport 8080 -j ACCEPT

# ... (other forward rules)

# End existing forward rules

# ... (other rules)

# Don't delete these required lines, otherwise, ufw will not work
-A ufw-before-input -j ufw-not-local
-A ufw-before-input -j DROP
-A ufw-before-output -j ACCEPT
-A ufw-before-forward -j ufw-not-local
-A ufw-before-forward -j DROP
# End required lines
